# НЕ  ЗАКОНЧЕНО

## Задание  


Задача: "Реализация механизма обработки платежей с поддержкой мультивалютности и динамической маршрутизацией"
Описание:  
Разработайте систему обработки платежных транзакций, которая:  
1. Поддерживает мультивалютные операции  
2. Динамически выбирает платежный шлюз на основе комиссий и доступности  
3. Обеспечивает идемпотентность операций  
4. Включает механизм автоматического повтора неудачных транзакций  


Требования:  
1. Базовый функционал:  
• Класс PaymentRequest с полями:  
• Amount (decimal)  
• Currency (enum)  
• SourceAccount (string)  
• DestinationAccount (string)  
• Metadata (Dictionary<string, string>)  


3. Валидация:  
• Проверка формата счетов (разные для разных валют)  
• Проверка лимитов операций (разные для разных валют)  
• Верификация баланса (имитация через сервис)  


5. Маршрутизация платежей:  
• Выбор оптимального шлюза на основе:  
• Комиссий (динамически получаемых из API)  
• Доступности шлюза  
• Валютных ограничений шлюза  


• Обработка транзакций:  
• Гарантия идемпотентности (обработка дублей)  
• Механизм retry с экспоненциальной задержкой   

  
• Транзакционный журнал со статусами:  
• Pending  
• Processed  
• Failed  
• Refunded  

  
7. Особые требования:  
• Поддержка частичных возвратов  
• Конвертация валют по динамическому курсу  
• Обработка нотификаций от платежных систем  


Критерии оценки:  


1. Качество кода:  
• SOLID принципы  
• Паттерны проектирования  
• Обработка ошибок  


3. Производительность:  
• Асинхронная обработка  
• Кеширование ставок  
• Оптимизация запросов  


5. Безопасность:  
• Валидация входных данных  
• Защита от повторных операций  
• Логирование критичных действий  


6. Тестирование:  
• Unit-тесты  
• Интеграционные тесты  
• Тесты на граничные случаи  
